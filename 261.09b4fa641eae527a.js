"use strict";(self.webpackChunksolidapp=self.webpackChunksolidapp||[]).push([[261],{9866:(Y,L,s)=>{s.r(L),s.d(L,{RolesModule:()=>oe,createTranslateLoader:()=>J});var r=s(9808),g=s(520),n=s(3075),c=s(1062),C=s(40),I=s(7006),y=s(3583),h=s(900),p=s(9291),m=s(7618),Z=s(9759),R=s(4971),e=s(5e3),O=s(2329),T=s(2340);let N=(()=>{class a{constructor(t){this.http=t}getAll(){return this.http.get(`${T.N.apiEndpoint}/roles`)}save(t){return this.http.post(`${T.N.apiEndpoint}/roles`,t)}update(t,o){return this.http.put(`${T.N.apiEndpoint}/roles/${t}`,o)}delete(t){return this.http.delete(`${T.N.apiEndpoint}/roles/${t}`)}getAllPermissions(){return this.http.get(`${T.N.apiEndpoint}/metadata/permissions?additional_fields=name%2Cparent_id%2Cpermission_type_id`)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(g.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var w=s(7071),_=s(5094),q=s(8966),P=s(291),D=s(722),b=s(4763),u=s(7093),f=s(7322),U=s(7531),M=s(4833);function Q(a,l){1&a&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ROLES.NAME.ERROR.REQUIRED")," "))}function B(a,l){if(1&a&&(e.TgZ(0,"mat-error"),e.YNc(1,Q,3,3,"div",5),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==t.rolesEditForm.controls.name.errors||!t.rolesEditForm.controls.name.errors.required))}}function G(a,l){1&a&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ROLES.DESCRIPTION.ERROR.REQUIRED")," "))}function $(a,l){if(1&a&&(e.TgZ(0,"mat-error"),e.YNc(1,G,3,3,"div",5),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==t.rolesEditForm.controls.description.errors||!t.rolesEditForm.controls.description.errors.required))}}let K=(()=>{class a{constructor(t,o,i,d,v,S,A,F,x){this.permissionService=t,this.rolesService=o,this.activatedRoute=i,this.router=d,this.snackbarService=v,this.store=S,this.translate=A,this.fb=F,this.dialog=x,this.appearanceType="outline",this.parentProp="name",this.childProp="parent_id",this.displayLabel="display_name",this.isItemSelectable=!0,this.isEditable=!1,this.hasMenuIcon=!0,this.hasMultipleSelection=!0,this.treeSelection=[],this.dataLoaded=!1,this.isDisabled=!0,this.store.select(R.D6).subscribe(E=>{this.translate.use(E.userPreference.language),this.appearanceType=E.userPreference.appearanceType,this.direction=E.userPreference.direction})}ngOnInit(){this.selectedRole=JSON.parse(localStorage.getItem("selectedItem")),this.selectedRole.addldata&&this.selectedRole.addldata.permissions&&(this.treeSelection=this.selectedRole.addldata.permissions),this.selectedRoleId=this.selectedRole.id,this.rolesEditForm=this.fb.group({name:new n.NI(""),description:new n.NI("")}),this.rolesEditForm.patchValue({name:this.selectedRole.name,description:this.selectedRole.description}),this.rolesEditForm.disable(),this.getPermissions()}updateRole(){const t=Object.assign({addldata:{permissions:this.userpermissions}},this.rolesEditForm.value);let o=JSON.parse(localStorage.getItem("user"));o.permissions=this.userpermissions,localStorage.setItem("user",JSON.stringify(o)),this.rolesService.update(this.selectedRoleId,t).subscribe({next:i=>{this.snackbarService.info(this.translate.instant("ROLES.SUCCESS.UPDATE")),this.router.navigate(["./../../"],{relativeTo:this.activatedRoute})},error:i=>this.snackbarService.warn(this.translate.instant("ROLES.ERROR.UPDATE"))})}getPageAction(t){const o=t.toString();"update"===o?this.updateRole():"delete"===o?this.deleteRole():"modify"===o&&(this.rolesEditForm.enable(),this.isDisabled=!1)}deleteRole(){this.dialog.open(Z.p,{disableClose:!0,direction:this.direction}).afterClosed().subscribe(o=>{"OK"===o&&this.rolesService.delete(this.selectedRoleId).subscribe({next:i=>{this.snackbarService.info(this.translate.instant("ROLES.SUCCESS.DELETE")),this.router.navigate(["./../../"],{relativeTo:this.activatedRoute})},error:i=>this.snackbarService.warn(this.translate.instant("ROLES.ERROR.DELETE"))})})}getSelection(t){let o=new Set;if(null!=t.selectedNodes&&t.selectedNodes.length>0)for(var i of t.selectedNodes)null!=i.permission_type_id&&4===i.permission_type_id&&o.add(i.parent_id),o.add(i.name);this.userpermissions=[...o]}getPermissions(){this.dataLoaded=!1,this.rolesService.getAllPermissions().subscribe({next:t=>{this.data=t,this.dataLoaded=!0},error:t=>{this.dataLoaded=!0}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(O.$),e.Y36(N),e.Y36(p.gz),e.Y36(p.F0),e.Y36(w.o),e.Y36(_.yh),e.Y36(c.sK),e.Y36(n.qu),e.Y36(q.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-role-edit"]],decls:23,vars:28,consts:[[3,"title","showEditBack","showIcon","selectedId","showDelete","pageAction"],["fxLayout","row wrap","fxLayoutAlign","start start","fxLayoutGap","10px grid","fxFlexFill","",1,"pt-2","pb-2",3,"formGroup"],["fxFlex","50","fxLayout","column"],[3,"appearance"],["formControlName","name","matInput","","required",""],[4,"ngIf"],["formControlName","description","matInput","","required",""],["fxLayout","column","fxLayoutGap","10px"],["fxFlexFill","",3,"dataLoaded","parentProperty","childProperty","displayLabel","treedata","isItemSelectable","hasIcon","hasMultipleSelection","treeSelection","isDisabled","selection"]],template:function(t,o){1&t&&(e.TgZ(0,"app-page"),e.TgZ(1,"app-page-header",0),e.NdJ("pageAction",function(d){return o.getPageAction(d)}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"app-page-body"),e.TgZ(4,"form",1),e.TgZ(5,"div",2),e.TgZ(6,"mat-form-field",3),e.TgZ(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"input",4),e.YNc(11,B,2,1,"mat-error",5),e.qZA(),e.qZA(),e.TgZ(12,"div",2),e.TgZ(13,"mat-form-field",3),e.TgZ(14,"mat-label"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e._UZ(17,"input",6),e.YNc(18,$,2,1,"mat-error",5),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",7),e.TgZ(20,"h2"),e._uU(21,"Permissions"),e.qZA(),e.TgZ(22,"app-shared-tree",8),e.NdJ("selection",function(d){return o.getSelection(d)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("title",e.lcZ(2,22,"ROLES.EDIT"))("showEditBack",!0)("showIcon",!0)("selectedId",o.permissionService.hasPermission("ROLE-UPDATE")?o.selectedRoleId:null)("showDelete",o.permissionService.hasPermission("ROLE-DELETE")),e.xp6(3),e.Q6J("formGroup",o.rolesEditForm),e.xp6(2),e.Q6J("appearance",o.appearanceType),e.xp6(2),e.Oqu(e.lcZ(9,24,"ROLES.NAME.TITLE")),e.xp6(3),e.Q6J("ngIf",!!o.rolesEditForm.controls.name.invalid&&!!o.rolesEditForm.controls.name.touched),e.xp6(2),e.Q6J("appearance",o.appearanceType),e.xp6(2),e.Oqu(e.lcZ(16,26,"ROLES.DESCRIPTION.TITLE")),e.xp6(3),e.Q6J("ngIf",!!o.rolesEditForm.controls.description.invalid&&!!o.rolesEditForm.controls.description.touched),e.xp6(4),e.Q6J("dataLoaded",o.dataLoaded)("parentProperty",o.parentProp)("childProperty",o.childProp)("displayLabel",o.displayLabel)("treedata",o.data)("isItemSelectable",o.isItemSelectable)("hasIcon",o.hasMenuIcon)("hasMultipleSelection",o.hasMultipleSelection)("treeSelection",o.treeSelection)("isDisabled",o.isDisabled))},directives:[P.I,D.q,b.H,n._Y,n.JL,u.xw,u.Wh,u.SQ,u.s9,n.sg,u.yH,f.KE,f.hX,n.Fj,U.Nt,n.JJ,n.u,n.Q7,r.O5,M.q,f.TO],pipes:[c.X$],styles:[""]}),a})();function X(a,l){1&a&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ROLES.NAME.ERROR.REQUIRED")," "))}function j(a,l){if(1&a&&(e.TgZ(0,"mat-error"),e.YNc(1,X,3,3,"div",5),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==t.rolesCreateForm.controls.name.errors||!t.rolesCreateForm.controls.name.errors.required))}}function W(a,l){1&a&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ROLES.DESCRIPTION.ERROR.REQUIRED")," "))}function H(a,l){if(1&a&&(e.TgZ(0,"mat-error"),e.YNc(1,W,3,3,"div",5),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==t.rolesCreateForm.controls.description.errors||!t.rolesCreateForm.controls.description.errors.required))}}let z=(()=>{class a{constructor(t,o,i,d,v,S,A,F,x){this.permissionService=t,this.rolesService=o,this.activatedRoute=i,this.router=d,this.snackbarService=v,this.store=S,this.translate=A,this.fb=F,this.cdRef=x,this.appearanceType="outline",this.parentProp="name",this.childProp="parent_id",this.displayLabel="display_name",this.isItemSelectable=!0,this.isEditable=!1,this.hasMenuIcon=!0,this.hasMultipleSelection=!0,this.dataLoaded=!1,this.store.select(R.D6).subscribe(E=>{this.translate.use(E.userPreference.language),this.appearanceType=E.userPreference.appearanceType})}ngOnInit(){this.rolesCreateForm=this.fb.group({name:new n.NI(""),description:new n.NI("")}),this.getPermissions()}ngAfterViewInit(){this.cdRef.detectChanges()}getSelection(t){let o=new Set;if(null!=t.selectedNodes&&t.selectedNodes.length>0)for(var i of t.selectedNodes)this.addParentPermission(i.name,o);this.userpermissions=[...o]}addParentPermission(t,o){this.data.filter(i=>{i.name===t&&(o.add(i.name),i.parent_id&&this.addParentPermission(i.parent_id,o))})}saveRole(){const t=Object.assign({addldata:{permissions:this.userpermissions}},this.rolesCreateForm.value);this.rolesService.save(t).subscribe({next:o=>{this.snackbarService.info(this.translate.instant("ROLES.SUCCESS.CREATE")),this.router.navigate(["./../"],{relativeTo:this.activatedRoute})},error:o=>this.snackbarService.warn(this.translate.instant("ROLES.ERROR.CREATE"))})}getPageAction(t){"save"===t.toString()&&this.saveRole()}getPermissions(){this.dataLoaded=!1,this.rolesService.getAllPermissions().subscribe({next:t=>{this.data=t,this.dataLoaded=!0},error:t=>{this.dataLoaded=!0}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(O.$),e.Y36(N),e.Y36(p.gz),e.Y36(p.F0),e.Y36(w.o),e.Y36(_.yh),e.Y36(c.sK),e.Y36(n.qu),e.Y36(e.sBO))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-role-new"]],decls:23,vars:26,consts:[[3,"title","showBack","showIcon","showSave","isDisabled","pageAction"],["fxLayout","row wrap","fxLayoutAlign","start start","fxLayoutGap","10px grid","fxFlexFill","",1,"pt-2","pb-2",3,"formGroup"],["fxFlex","50","fxLayout","column"],[3,"appearance"],["formControlName","name","matInput","","required",""],[4,"ngIf"],["formControlName","description","matInput","","required",""],["fxLayout","column","fxLayoutGap","10px"],["fxFlexFill","",3,"dataLoaded","parentProperty","childProperty","displayLabel","treedata","isItemSelectable","hasIcon","hasMultipleSelection","selection"]],template:function(t,o){1&t&&(e.TgZ(0,"app-page"),e.TgZ(1,"app-page-header",0),e.NdJ("pageAction",function(d){return o.getPageAction(d)}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"app-page-body"),e.TgZ(4,"form",1),e.TgZ(5,"div",2),e.TgZ(6,"mat-form-field",3),e.TgZ(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"input",4),e.YNc(11,j,2,1,"mat-error",5),e.qZA(),e.qZA(),e.TgZ(12,"div",2),e.TgZ(13,"mat-form-field",3),e.TgZ(14,"mat-label"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e._UZ(17,"input",6),e.YNc(18,H,2,1,"mat-error",5),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",7),e.TgZ(20,"h2"),e._uU(21,"Permissions"),e.qZA(),e.TgZ(22,"app-shared-tree",8),e.NdJ("selection",function(d){return o.getSelection(d)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("title",e.lcZ(2,20,"ROLES.CREATE"))("showBack",!0)("showIcon",!0)("showSave",!0)("isDisabled",!!o.rolesCreateForm.invalid),e.xp6(3),e.Q6J("formGroup",o.rolesCreateForm),e.xp6(2),e.Q6J("appearance",o.appearanceType),e.xp6(2),e.Oqu(e.lcZ(9,22,"ROLES.NAME.TITLE")),e.xp6(3),e.Q6J("ngIf",!!o.rolesCreateForm.controls.name.invalid&&!!o.rolesCreateForm.controls.name.touched),e.xp6(2),e.Q6J("appearance",o.appearanceType),e.xp6(2),e.Oqu(e.lcZ(16,24,"ROLES.DESCRIPTION.TITLE")),e.xp6(3),e.Q6J("ngIf",!!o.rolesCreateForm.controls.description.invalid&&!!o.rolesCreateForm.controls.description.touched),e.xp6(4),e.Q6J("dataLoaded",o.dataLoaded)("parentProperty",o.parentProp)("childProperty",o.childProp)("displayLabel",o.displayLabel)("treedata",o.data)("isItemSelectable",o.isItemSelectable)("hasIcon",o.hasMenuIcon)("hasMultipleSelection",o.hasMultipleSelection))},directives:[P.I,D.q,b.H,n._Y,n.JL,u.xw,u.Wh,u.SQ,u.s9,n.sg,u.yH,f.KE,f.hX,n.Fj,U.Nt,n.JJ,n.u,n.Q7,r.O5,M.q,f.TO],pipes:[c.X$],styles:[""]}),a})();var V=s(7142);const ee=[{canActivate:[m.a],path:"",component:(()=>{class a{constructor(t,o,i,d,v,S){this.permissionService=t,this.roleService=o,this.activatedRoute=i,this.router=d,this.store=v,this.translate=S,this.displayedColumns=["name","description"],this.headers=[{columnName:"name",display_name:"GRID.NAME"},{columnName:"description",display_name:"GRID.DESCRIPTION"}],this.dataLoaded=!1,this.searchString="",this.store.select(R.D6).subscribe(A=>{this.translate.use(A.userPreference.language)})}ngOnInit(){localStorage.removeItem("selectedItem"),this.getAllUsers()}getAllUsers(){this.roleService.getAll().subscribe({next:t=>{this.gridData=t,this.dataLoaded=!0},error:t=>{this.dataLoaded=!0,this.gridData=[]},complete:()=>{}})}selectedRowItem(t){this.permissionService.hasPermission("ROLE-UPDATE||ROLE-READ||ROLE-DELETE")&&(localStorage.setItem("selectedItem",JSON.stringify(t)),this.router.navigate(["./edit/"+t.id],{relativeTo:this.activatedRoute}))}selectedSelection(t){}getSearchString(t){this.searchString=t}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(O.$),e.Y36(N),e.Y36(p.gz),e.Y36(p.F0),e.Y36(_.yh),e.Y36(c.sK))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-roles"]],decls:6,vars:12,consts:[[3,"title","showIcon","showNew"],[1,"p-2"],[3,"showSkeleton","data","displayColumns","useCustomHeader","headers","showFilter","searchString","selectedRow","selectedSelection"]],template:function(t,o){1&t&&(e.TgZ(0,"app-page"),e._UZ(1,"app-page-header",0),e.ALo(2,"translate"),e.TgZ(3,"app-page-body"),e.TgZ(4,"div",1),e.TgZ(5,"app-shared-grid",2),e.NdJ("selectedRow",function(d){return o.selectedRowItem(d)})("selectedSelection",function(d){return o.selectedSelection(d)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("title",e.lcZ(2,10,"ROLES.PAGE-TITLE"))("showIcon",!0)("showNew",o.permissionService.hasPermission("ROLE-CREATE")),e.xp6(4),e.Q6J("showSkeleton",!o.dataLoaded)("data",o.gridData)("displayColumns",o.displayedColumns)("useCustomHeader",!0)("headers",o.headers)("showFilter",!1)("searchString",o.searchString))},directives:[P.I,D.q,b.H,V.M],pipes:[c.X$],styles:[""]}),a})(),data:{breadcrumb:"MENU.USER-MGMT.ROLE",permission_code:"ROLE-READ"}},{canActivate:[m.a],path:"new",component:z,data:{breadcrumb:"BUTTON.NEW",permission_code:"ROLE-CREATE"}},{canActivate:[m.a],path:"edit/:id",component:K,data:{breadcrumb:"BUTTON.EDIT",permission_code:"ROLE-UPDATE||ROLE-READ||ROLE-DELETE"}}];let te=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[p.Bz.forChild(ee)],p.Bz]}),a})();function J(a){return new C.w(a,"assets/i18n/",".json")}let oe=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[r.ez,te,I.q,n.u5,n.UX,c.aw.forChild({loader:{provide:c.Zw,useFactory:J,deps:[g.eN]},isolate:!0}),h.m,y._]]}),a})()},9759:(Y,L,s)=>{s.d(L,{p:()=>y});var r=s(5e3),g=s(8966),n=s(7093),c=s(7322),C=s(7423),I=s(1062);let y=(()=>{class h{constructor(m){this.dialogRef=m}onNoClick(){this.dialogRef.close()}delete(){this.dialogRef.close("OK")}}return h.\u0275fac=function(m){return new(m||h)(r.Y36(g.so))},h.\u0275cmp=r.Xpm({type:h,selectors:[["app-delete-confirmation"]],decls:12,vars:9,consts:[["fxLayout","column"],["mat-dialog-content","",2,"overflow","hidden"],[1,"mat-h2"],["mat-dialog-actions","","fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","5px",1,"mt-1"],["mat-stroked-button","","color","primary",3,"click"],["mat-stroked-button","","color","warn","cdkFocusInitial","",3,"click"]],template:function(m,Z){1&m&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"mat-label",2),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div",3),r.TgZ(6,"button",4),r.NdJ("click",function(){return Z.onNoClick()}),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"button",5),r.NdJ("click",function(){return Z.delete()}),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA(),r.qZA()),2&m&&(r.xp6(3),r.Oqu(r.lcZ(4,3,"BUTTON.DELETE-CONFIRMATION")),r.xp6(4),r.Oqu(r.lcZ(8,5,"BUTTON.CANCEL")),r.xp6(3),r.Oqu(r.lcZ(11,7,"BUTTON.DELETE")))},directives:[n.xw,g.xY,c.hX,g.H8,n.Wh,n.SQ,C.lW],pipes:[I.X$],styles:[""]}),h})()}}]);