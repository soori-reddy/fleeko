"use strict";(self.webpackChunksolidapp=self.webpackChunksolidapp||[]).push([[6586],{6586:(b,I,a)=>{a.r(I),a.d(I,{ServiceModule:()=>Me,createTranslateLoader:()=>M});var s=a(9808),g=a(520),n=a(3075),m=a(1062),x=a(40),R=a(7006),C=a(3583),T=a(900),p=a(9291),d=a(7618),A=a(9759),f=a(4971),e=a(5e3),y=a(2329),_=a(2340);let S=(()=>{class t{constructor(i){this.http=i}getAll(){return this.http.get(`${_.N.apiEndpoint}/org/config/item`)}save(i){return this.http.post(`${_.N.apiEndpoint}/org/config/item`,i)}getDivision(){return this.http.get(`${_.N.apiEndpoint}/org/config/division`)}update(i,r){return this.http.put(`${_.N.apiEndpoint}/org/config/item/${i}`,r)}delete(i){return this.http.delete(`${_.N.apiEndpoint}/org/config/item/${i}`)}getAccounts(){return this.http.get(`${_.N.apiEndpoint}/metadata/accounttype`)}}return t.\u0275fac=function(i){return new(i||t)(e.LFG(g.eN))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var U=a(7071),P=a(8966),L=a(8485),N=a(5094),q=a(291),F=a(722),O=a(4763),v=a(7093),u=a(7322),Q=a(7531),J=a(4107),w=a(508);function j(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.ITEM-CODE.ERROR.REQUIRED")," "))}function V(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,j,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.name.errors||!i.servicesEditForm.controls.name.errors.required))}}function X(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.DESCRIPTION.ERROR.REQUIRED")," "))}function $(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,X,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.description.errors||!i.servicesEditForm.controls.description.errors.required))}}function B(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const i=o.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i.name," ")}}function W(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.DIVISION.ERROR.REQUIRED")," "))}function G(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,W,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.division.errors||!i.servicesEditForm.controls.division.errors.required))}}function H(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=o.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",e.lcZ(2,2,i.display_name)," ")}}function k(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.PRICE.ERROR.REQUIRED")," "))}function K(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.PRICE.ERROR.MIN")," "))}function z(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,k,3,3,"div",6),e.YNc(2,K,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.price.errors||!i.servicesEditForm.controls.price.errors.required)),e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.price.errors||!i.servicesEditForm.controls.price.errors.min))}}function ee(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const i=o.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i.value," ")}}function te(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.PRICE-TYPE.ERROR.REQUIRED")," "))}function ie(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,te,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.account.errors||!i.servicesEditForm.controls.account.errors.required))}}function re(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=o.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",e.lcZ(2,2,i.display_name)," ")}}function oe(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.ACCOUNT.ERROR.REQUIRED")," "))}function ne(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,oe,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.account.errors||!i.servicesEditForm.controls.account.errors.required))}}function ae(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.TAX-RATE.ERROR.REQUIRED")," "))}function se(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.TAX-RATE.ERROR.MIN")," "))}function ce(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.TAX-RATE.ERROR.MAX")," "))}function le(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,ae,3,3,"div",6),e.YNc(2,se,3,3,"div",6),e.YNc(3,ce,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.tax_rate.errors||!i.servicesEditForm.controls.tax_rate.errors.required)),e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.tax_rate.errors||!i.servicesEditForm.controls.tax_rate.errors.min)),e.xp6(1),e.Q6J("ngIf",!(null==i.servicesEditForm.controls.tax_rate.errors||!i.servicesEditForm.controls.tax_rate.errors.max))}}let pe=(()=>{class t{constructor(i,r,c,l,E,Z,h,D,Ye){this.permissionService=i,this.translate=r,this.servicesService=c,this.snackbarService=l,this.activatedRoute=E,this.router=Z,this.dialog=h,this.themingService=D,this.store=Ye,this.appearanceType="legacy",this.filteredDivisions=[],this.priceTypes=[{id:0,value:"Fixed"},{id:1,value:"Hourly based"}],this.store.select(f.D6).subscribe(Y=>{this.appearanceType=Y.userPreference.appearanceType,this.direction=Y.userPreference.direction})}ngOnInit(){this.selectedOrgItem=JSON.parse(localStorage.getItem("selectedItem")),this.selectedOrgItemId=this.selectedOrgItem.id,this.servicesEditForm=new n.cw({name:new n.NI("",n.kI.required),description:new n.NI("",n.kI.required),tax_rate:new n.NI("",[n.kI.required,n.kI.min(0),n.kI.max(100)]),price:new n.NI("",[n.kI.required,n.kI.min(0)]),account:new n.NI("",n.kI.required),division:new n.NI("",n.kI.required),sub_division:new n.NI(""),price_type:new n.NI("",n.kI.required)}),this.getDivision(),this.getAccounts(),this.servicesEditForm.setValue({name:this.selectedOrgItem.name,description:this.selectedOrgItem.description,tax_rate:this.selectedOrgItem.tax_rate,price:this.selectedOrgItem.price,account:this.selectedOrgItem.account,division:this.selectedOrgItem.division,sub_division:this.selectedOrgItem.sub_division,price_type:this.priceTypes[0]}),this.subDivisions=this.selectedOrgItem.division.children,this.servicesEditForm.disable()}getDivision(){this.servicesService.getDivision().subscribe(i=>{this.divisions=i,this.divisions.forEach(r=>{r.has_sub_divisions&&this.filteredDivisions.push(r)}),this.subDivisions=this.divisions.filter(r=>r.parent_id===this.selectedOrgItem.division.id)})}onDivsionChange(i){const r=i.value;this.subDivisions=this.divisions.filter(c=>c.parent_id===r.id),this.servicesEditForm.patchValue({sub_division:null})}getAccounts(){this.servicesService.getAccounts().subscribe(i=>{this.accounts=i})}updateItem(){this.servicesService.update(this.selectedOrgItem.id,this.servicesEditForm.value).subscribe({next:r=>{this.snackbarService.info(this.translate.instant("ITEM.SUCCESS.UPDATE")),this.router.navigate(["./../../"],{relativeTo:this.activatedRoute})},error:r=>this.snackbarService.warn(this.translate.instant("ITEM.ERROR.UPDATE"))})}deleteItem(){this.dialog.open(A.p,{disableClose:!0,direction:this.direction}).afterClosed().subscribe(r=>{"OK"===r&&this.servicesService.delete(this.selectedOrgItem.id).subscribe({next:c=>{this.snackbarService.info(this.translate.instant("ITEM.SUCCESS.DELETE")),this.router.navigate(["./../../"],{relativeTo:this.activatedRoute})},error:c=>this.snackbarService.warn(this.translate.instant("ITEM.ERROR.DELETE"))})})}compareFn(i,r){return i&&r?i.id===r.id:i===r}getPageAction(i){const r=i.toString();"delete"===r?this.deleteItem():"update"===r?this.updateItem():"modify"===r&&this.servicesEditForm.enable()}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(y.$),e.Y36(m.sK),e.Y36(S),e.Y36(U.o),e.Y36(p.gz),e.Y36(p.F0),e.Y36(P.uw),e.Y36(L.m),e.Y36(N.yh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-service-edit"]],decls:69,vars:55,consts:[[3,"title","showEditBack","showIcon","selectedId","showDelete","pageAction"],[1,"pt-2","pb-2",3,"formGroup"],["fxLayout","row wrap","fxFlex","1 1 100%","fxLayoutAlign","start center","fxLayoutGap","10px grid"],["fxFlex","33.33","fxFlex.lg","25","fxFlex.sm","50","fxFlex.gt-lg","20","fxFlex.xs","100","fxLayout","column"],[3,"appearance"],["formControlName","name","type","text","matInput","","required",""],[4,"ngIf"],["formControlName","description","type","text","matInput","","required",""],["formControlName","division","required","",3,"compareWith","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","sub_division",3,"compareWith"],["formControlName","price","type","number","min","0","matInput","","required",""],["matPrefix",""],["formControlName","price_type","required","",3,"compareWith"],["formControlName","account","required","",3,"compareWith"],["formControlName","tax_rate","type","number","matInput",""],["matSuffix",""],[3,"value"]],template:function(i,r){1&i&&(e.TgZ(0,"app-page"),e.TgZ(1,"app-page-header",0),e.NdJ("pageAction",function(l){return r.getPageAction(l)}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"app-page-body"),e.TgZ(4,"form",1),e.TgZ(5,"div",2),e.TgZ(6,"div",3),e.TgZ(7,"mat-form-field",4),e.TgZ(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"input",5),e.YNc(12,V,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(13,"div",3),e.TgZ(14,"mat-form-field",4),e.TgZ(15,"mat-label"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"input",7),e.YNc(19,$,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(20,"div",3),e.TgZ(21,"mat-form-field",4),e.TgZ(22,"mat-label"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"mat-select",8),e.NdJ("selectionChange",function(l){return r.onDivsionChange(l)}),e.YNc(26,B,2,2,"mat-option",9),e.qZA(),e.YNc(27,G,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(28,"div",3),e.TgZ(29,"mat-form-field",4),e.TgZ(30,"mat-label"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"mat-select",10),e.YNc(34,H,3,4,"mat-option",9),e.qZA(),e.qZA(),e.qZA(),e.TgZ(35,"div",3),e.TgZ(36,"mat-form-field",4),e.TgZ(37,"mat-label"),e._uU(38),e.ALo(39,"translate"),e.qZA(),e._UZ(40,"input",11),e.TgZ(41,"span",12),e._uU(42,"$"),e.qZA(),e.YNc(43,z,3,2,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(44,"div",3),e.TgZ(45,"mat-form-field",4),e.TgZ(46,"mat-label"),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"mat-select",13),e.YNc(50,ee,2,2,"mat-option",9),e.qZA(),e.YNc(51,ie,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(52,"div",3),e.TgZ(53,"mat-form-field",4),e.TgZ(54,"mat-label"),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.TgZ(57,"mat-select",14),e.YNc(58,re,3,4,"mat-option",9),e.qZA(),e.YNc(59,ne,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(60,"div",3),e.TgZ(61,"mat-form-field",4),e.TgZ(62,"mat-label"),e._uU(63),e.ALo(64,"translate"),e.qZA(),e._UZ(65,"input",15),e.TgZ(66,"span",16),e._uU(67,"%"),e.qZA(),e.YNc(68,le,4,3,"mat-error",6),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i&&(e.xp6(1),e.Q6J("title",e.lcZ(2,37,"ITEM.EDIT"))("showEditBack",!0)("showIcon",!0)("selectedId",r.permissionService.hasPermission("SERVICES-UPDATE")?r.selectedOrgItemId:null)("showDelete",r.permissionService.hasPermission("SERVICES-DELETE")),e.xp6(3),e.Q6J("formGroup",r.servicesEditForm),e.xp6(3),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(10,39,"ITEM.ITEM-CODE.TITLE")),e.xp6(3),e.Q6J("ngIf",!!r.servicesEditForm.controls.name.invalid&&!!r.servicesEditForm.controls.name.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(17,41,"ITEM.DESCRIPTION.TITLE")),e.xp6(3),e.Q6J("ngIf",!!r.servicesEditForm.controls.description.invalid&&!!r.servicesEditForm.controls.description.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(24,43,"ITEM.DIVISION.TITLE")),e.xp6(2),e.Q6J("compareWith",r.compareFn),e.xp6(1),e.Q6J("ngForOf",r.filteredDivisions),e.xp6(1),e.Q6J("ngIf",!!r.servicesEditForm.controls.division.invalid&&!!r.servicesEditForm.controls.division.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(32,45,"ITEM.SUB-DIVISION.TITLE")),e.xp6(2),e.Q6J("compareWith",r.compareFn),e.xp6(1),e.Q6J("ngForOf",r.subDivisions),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(39,47,"ITEM.PRICE.TITLE")),e.xp6(5),e.Q6J("ngIf",!!r.servicesEditForm.controls.price.invalid&&!!r.servicesEditForm.controls.price.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(48,49,"ITEM.PRICE-TYPE.TITLE")),e.xp6(2),e.Q6J("compareWith",r.compareFn),e.xp6(1),e.Q6J("ngForOf",r.priceTypes),e.xp6(1),e.Q6J("ngIf",!!r.servicesEditForm.controls.account.invalid&&!!r.servicesEditForm.controls.account.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(56,51,"ITEM.ACCOUNT.TITLE")),e.xp6(2),e.Q6J("compareWith",r.compareFn),e.xp6(1),e.Q6J("ngForOf",r.accounts),e.xp6(1),e.Q6J("ngIf",!!r.servicesEditForm.controls.account.invalid&&!!r.servicesEditForm.controls.account.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(64,53,"ITEM.TAX-RATE.TITLE")),e.xp6(5),e.Q6J("ngIf",!!r.servicesEditForm.controls.tax_rate.invalid&&!!r.servicesEditForm.controls.tax_rate.touched))},directives:[q.I,F.q,O.H,n._Y,n.JL,n.sg,v.xw,v.yH,v.Wh,v.SQ,u.KE,u.hX,n.Fj,Q.Nt,n.JJ,n.u,n.Q7,s.O5,J.gD,s.sg,n.wV,n.qQ,u.qo,u.R9,u.TO,w.ey],pipes:[m.X$],styles:[""]}),t})();var me=a(3874);function de(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.ITEM-CODE.ERROR.REQUIRED")," "))}function ue(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,de,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.name.errors||!i.servicesForm.controls.name.errors.required))}}function ve(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.DESCRIPTION.ERROR.REQUIRED")," "))}function Te(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,ve,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.description.errors||!i.servicesForm.controls.description.errors.required))}}function ge(t,o){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&t){const i=o.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i.name," ")}}function _e(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.DIVISION.ERROR.REQUIRED")," "))}function fe(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,_e,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.division.errors||!i.servicesForm.controls.division.errors.required))}}function Ee(t,o){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=o.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",e.lcZ(2,2,i.display_name)," ")}}function Ze(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.PRICE.ERROR.REQUIRED")," "))}function he(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.PRICE.ERROR.MIN")," "))}function Ie(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,Ze,3,3,"div",6),e.YNc(2,he,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.price.errors||!i.servicesForm.controls.price.errors.required)),e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.price.errors||!i.servicesForm.controls.price.errors.min))}}function Ae(t,o){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&t){const i=o.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i.value," ")}}function xe(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.PRICE-TYPE.ERROR.REQUIRED")," "))}function Re(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,xe,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.account.errors||!i.servicesForm.controls.account.errors.required))}}function Ce(t,o){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const i=o.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",e.lcZ(2,2,i.display_name)," ")}}function Se(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.ACCOUNT.ERROR.REQUIRED")," "))}function Ne(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,Se,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.account.errors||!i.servicesForm.controls.account.errors.required))}}function qe(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.TAX-RATE.ERROR.REQUIRED")," "))}function Fe(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.TAX-RATE.ERROR.MIN")," "))}function Oe(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ITEM.TAX-RATE.ERROR.MAX")," "))}function De(t,o){if(1&t&&(e.TgZ(0,"mat-error"),e.YNc(1,qe,3,3,"div",6),e.YNc(2,Fe,3,3,"div",6),e.YNc(3,Oe,3,3,"div",6),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.tax_rate.errors||!i.servicesForm.controls.tax_rate.errors.required)),e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.tax_rate.errors||!i.servicesForm.controls.tax_rate.errors.min)),e.xp6(1),e.Q6J("ngIf",!(null==i.servicesForm.controls.tax_rate.errors||!i.servicesForm.controls.tax_rate.errors.max))}}let ye=(()=>{class t{constructor(i,r,c,l,E,Z,h){this.translate=i,this._servicesService=r,this.snackbarService=c,this.activatedRoute=l,this.router=E,this.store=Z,this.themingService=h,this.filteredDivisions=[],this.priceTypes=[{id:0,value:"Fixed"},{id:1,value:"Hourly based"}],this.appearanceType="outline",this.store.select(f.D6).subscribe(D=>{this.appearanceType=D.userPreference.appearanceType})}ngOnInit(){this.servicesForm=new n.cw({name:new n.NI("",n.kI.required),description:new n.NI("",n.kI.required),tax_rate:new n.NI("",[n.kI.required,n.kI.min(0),n.kI.max(100)]),price:new n.NI("",[n.kI.required,n.kI.min(0)]),account:new n.NI("",n.kI.required),division:new n.NI("",n.kI.required),sub_division:new n.NI(""),price_type:new n.NI("",n.kI.required)}),this.getDivision(),this.getAccounts()}getDivision(){this._servicesService.getDivision().subscribe(i=>{this.divisions=i,this.divisions.forEach(r=>{r.has_sub_divisions&&this.filteredDivisions.push(r)})})}onDivsionChange(i){const r=i.value;this.subDivisions=this.divisions.filter(c=>c.parent_id===r.id),this.servicesForm.patchValue({sub_division:null})}getAccounts(){this._servicesService.getAccounts().subscribe(i=>{this.accounts=i})}saveItem(){this._servicesService.save(this.servicesForm.value).subscribe({next:r=>{this.snackbarService.info(this.translate.instant("ITEM.SUCCESS.CREATE")),this.router.navigate(["./../"],{relativeTo:this.activatedRoute})},error:r=>this.snackbarService.warn(this.translate.instant("ITEM.ERROR.CREATE"))})}getPageAction(i){"save"===i.toString()&&this.saveItem()}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(m.sK),e.Y36(S),e.Y36(U.o),e.Y36(p.gz),e.Y36(p.F0),e.Y36(N.yh),e.Y36(L.m))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-service-new"]],decls:69,vars:51,consts:[[3,"title","showBack","showIcon","showSave","isDisabled","pageAction"],[1,"pt-2","pb-2",3,"formGroup"],["fxLayout","row wrap","fxFlex","1 1 100%","fxLayoutAlign","start center","fxLayoutGap","10px grid"],["fxFlex.gt-lg","20","fxFlex.lg","25","fxFlex","33.33","fxFlex.sm","50","fxFlex.xs","100","fxLayout","column"],[3,"appearance"],["formControlName","name","type","text","matInput","","required",""],[4,"ngIf"],["fxFlex","33.33","fxFlex.lg","25","fxFlex.sm","50","fxFlex.gt-lg","20","fxFlex.xs","100","fxLayout","column"],["formControlName","description","type","text","matInput","","required",""],["formControlName","division","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","sub_division"],["formControlName","price","type","number","matInput","","required",""],["matPrefix",""],[1,"las","la-dollar-sign"],["formControlName","price_type","required",""],["formControlName","account","required",""],["formControlName","tax_rate","type","number","matInput","","required",""],["matSuffix",""],[1,"las","la-percentage"],[3,"value"]],template:function(i,r){1&i&&(e.TgZ(0,"app-page"),e.TgZ(1,"app-page-header",0),e.NdJ("pageAction",function(l){return r.getPageAction(l)}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"app-page-body"),e.TgZ(4,"form",1),e.TgZ(5,"div",2),e.TgZ(6,"div",3),e.TgZ(7,"mat-form-field",4),e.TgZ(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"input",5),e.YNc(12,ue,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(13,"div",7),e.TgZ(14,"mat-form-field",4),e.TgZ(15,"mat-label"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"input",8),e.YNc(19,Te,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(20,"div",7),e.TgZ(21,"mat-form-field",4),e.TgZ(22,"mat-label"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"mat-select",9),e.NdJ("selectionChange",function(l){return r.onDivsionChange(l)}),e.YNc(26,ge,2,2,"mat-option",10),e.qZA(),e.YNc(27,fe,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(28,"div",7),e.TgZ(29,"mat-form-field",4),e.TgZ(30,"mat-label"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"mat-select",11),e.YNc(34,Ee,3,4,"mat-option",10),e.qZA(),e.qZA(),e.qZA(),e.TgZ(35,"div",7),e.TgZ(36,"mat-form-field",4),e.TgZ(37,"mat-label"),e._uU(38),e.ALo(39,"translate"),e.qZA(),e._UZ(40,"input",12),e.TgZ(41,"mat-icon",13),e._UZ(42,"i",14),e.qZA(),e.YNc(43,Ie,3,2,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(44,"div",7),e.TgZ(45,"mat-form-field",4),e.TgZ(46,"mat-label"),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"mat-select",15),e.YNc(50,Ae,2,2,"mat-option",10),e.qZA(),e.YNc(51,Re,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(52,"div",7),e.TgZ(53,"mat-form-field",4),e.TgZ(54,"mat-label"),e._uU(55),e.ALo(56,"translate"),e.qZA(),e.TgZ(57,"mat-select",16),e.YNc(58,Ce,3,4,"mat-option",10),e.qZA(),e.YNc(59,Ne,2,1,"mat-error",6),e.qZA(),e.qZA(),e.TgZ(60,"div",7),e.TgZ(61,"mat-form-field",4),e.TgZ(62,"mat-label"),e._uU(63),e.ALo(64,"translate"),e.qZA(),e._UZ(65,"input",17),e.TgZ(66,"mat-icon",18),e._UZ(67,"i",19),e.qZA(),e.YNc(68,De,4,3,"mat-error",6),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i&&(e.xp6(1),e.Q6J("title",e.lcZ(2,33,"ITEM.CREATE"))("showBack",!0)("showIcon",!0)("showSave",!0)("isDisabled",r.servicesForm.invalid),e.xp6(3),e.Q6J("formGroup",r.servicesForm),e.xp6(3),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(10,35,"ITEM.ITEM-CODE.TITLE")),e.xp6(3),e.Q6J("ngIf",!!r.servicesForm.controls.name.invalid&&!!r.servicesForm.controls.name.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(17,37,"ITEM.DESCRIPTION.TITLE")),e.xp6(3),e.Q6J("ngIf",!!r.servicesForm.controls.description.invalid&&!!r.servicesForm.controls.description.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(24,39,"ITEM.DIVISION.TITLE")),e.xp6(3),e.Q6J("ngForOf",r.filteredDivisions),e.xp6(1),e.Q6J("ngIf",!!r.servicesForm.controls.division.invalid&&!!r.servicesForm.controls.division.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(32,41,"ITEM.SUB-DIVISION.TITLE")),e.xp6(3),e.Q6J("ngForOf",r.subDivisions),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(39,43,"ITEM.PRICE.TITLE")),e.xp6(5),e.Q6J("ngIf",!!r.servicesForm.controls.price.invalid&&!!r.servicesForm.controls.price.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(48,45,"ITEM.PRICE-TYPE.TITLE")),e.xp6(3),e.Q6J("ngForOf",r.priceTypes),e.xp6(1),e.Q6J("ngIf",!!r.servicesForm.controls.account.invalid&&!!r.servicesForm.controls.account.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(56,47,"ITEM.ACCOUNT.TITLE")),e.xp6(3),e.Q6J("ngForOf",r.accounts),e.xp6(1),e.Q6J("ngIf",!!r.servicesForm.controls.account.invalid&&!!r.servicesForm.controls.account.touched),e.xp6(2),e.Q6J("appearance",r.appearanceType),e.xp6(2),e.Oqu(e.lcZ(64,49,"ITEM.TAX-RATE.TITLE")),e.xp6(5),e.Q6J("ngIf",!!r.servicesForm.controls.tax_rate.invalid&&!!r.servicesForm.controls.tax_rate.touched))},directives:[q.I,F.q,O.H,n._Y,n.JL,n.sg,v.xw,v.yH,v.Wh,v.SQ,u.KE,u.hX,n.Fj,Q.Nt,n.JJ,n.u,n.Q7,s.O5,J.gD,s.sg,n.wV,me.Hw,u.qo,u.R9,u.TO,w.ey],pipes:[m.X$],styles:[""]}),t})();var Ue=a(7142);function Le(t,o){if(1&t){const i=e.EpF();e.TgZ(0,"app-shared-grid",3),e.NdJ("selectedRow",function(c){return e.CHM(i),e.oxw().selectedRowItem(c)}),e.qZA()}if(2&t){const i=e.oxw();e.Q6J("data",i.filteredRecords)("displayColumns",i.displayedColumns)("useCustomHeader",!0)("headers",i.headers)("showFilter",!1)("searchString",i.searchString)}}const Je=[{canActivate:[d.a],path:"",component:(()=>{class t{constructor(i,r,c,l,E,Z){this.permissionService=i,this.servicesService=r,this.activatedRoute=c,this.router=l,this.store=E,this.translate=Z,this.displayedColumns=["name","description","class","subClass","accountName","tax_rate","price"],this.headers=[{columnName:"class",display_name:"GRID.DIVISION"},{columnName:"subClass",display_name:"GRID.SUB-DIVISION"},{columnName:"name",display_name:"GRID.NAME"},{columnName:"description",display_name:"GRID.DESCRIPTION"},{columnName:"accountName",display_name:"GRID.ACCOUNT"},{columnName:"tax_rate",display_name:"GRID.TAXRATE"},{columnName:"price",display_name:"GRID.PRICE"}],this.gridData=[],this.dataLoaded=!1,this.searchString="",this.filteredRecords=[],this.store.select(f.D6).subscribe(h=>{this.translate.use(h.userPreference.language)})}ngOnInit(){this.getAllItems()}getAllItems(){this.servicesService.getAll().subscribe({next:i=>{this.gridData=i,this.filteredRecords=i;for(const r of this.gridData)r.class=r.division.name,r.subClass=r.sub_division?r.sub_division.display_name:"",r.accountName=r.account.display_name;this.dataLoaded=!0},error:i=>{this.dataLoaded=!0,this.gridData=[]}})}selectedRowItem(i){this.permissionService.hasPermission("SERVICES-UPDATE||SERVICES-CREATE||SERVICES-READ")&&(localStorage.setItem("selectedItem",JSON.stringify(i)),this.router.navigate(["./edit/"+i.id],{relativeTo:this.activatedRoute}))}getSearchString(i){this.searchString=i}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(y.$),e.Y36(S),e.Y36(p.gz),e.Y36(p.F0),e.Y36(N.yh),e.Y36(m.sK))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-service"]],decls:7,vars:10,consts:[[3,"title","showNew","showIcon","showSearch","searchPlaceholder","emitSearchString"],[1,"p-2"],[3,"data","displayColumns","useCustomHeader","headers","showFilter","searchString","selectedRow",4,"ngIf"],[3,"data","displayColumns","useCustomHeader","headers","showFilter","searchString","selectedRow"]],template:function(i,r){1&i&&(e.TgZ(0,"app-page"),e.TgZ(1,"app-page-header",0),e.NdJ("emitSearchString",function(l){return r.getSearchString(l)}),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"app-page-body"),e.TgZ(5,"div",1),e.YNc(6,Le,1,6,"app-shared-grid",2),e.qZA(),e.qZA(),e.qZA()),2&i&&(e.xp6(1),e.Q6J("title",e.lcZ(2,6,"ITEM.PAGE-TITLE"))("showNew",r.permissionService.hasPermission("SERVICES-CREATE"))("showIcon",!0)("showSearch",!0)("searchPlaceholder",e.lcZ(3,8,"ITEM.SEARCH-PLACEHOLDER")),e.xp6(5),e.Q6J("ngIf",r.dataLoaded))},directives:[q.I,F.q,O.H,s.O5,Ue.M],pipes:[m.X$],styles:[""]}),t})(),data:{breadcrumb:"",permission_code:"SERVICES-READ"}},{canActivate:[d.a],path:"new",component:ye,data:{breadcrumb:"BUTTON.NEW",permission_code:"SERVICES-CREATE"}},{canActivate:[d.a],path:"edit/:id",component:pe,data:{breadcrumb:"BUTTON.EDIT",permission_code:"SERVICES-UPDATE||SERVICES-CREATE||SERVICES-READ"}}];let we=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[p.Bz.forChild(Je)],p.Bz]}),t})();function M(t){return new x.w(t,"assets/i18n/",".json")}let Me=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[s.ez,we,m.aw.forChild({loader:{provide:m.Zw,useFactory:M,deps:[g.eN]},isolate:!0}),R.q,n.UX,n.u5,T.m,C._]]}),t})()},9759:(b,I,a)=>{a.d(I,{p:()=>C});var s=a(5e3),g=a(8966),n=a(7093),m=a(7322),x=a(7423),R=a(1062);let C=(()=>{class T{constructor(d){this.dialogRef=d}onNoClick(){this.dialogRef.close()}delete(){this.dialogRef.close("OK")}}return T.\u0275fac=function(d){return new(d||T)(s.Y36(g.so))},T.\u0275cmp=s.Xpm({type:T,selectors:[["app-delete-confirmation"]],decls:12,vars:9,consts:[["fxLayout","column"],["mat-dialog-content","",2,"overflow","hidden"],[1,"mat-h2"],["mat-dialog-actions","","fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","5px",1,"mt-1"],["mat-stroked-button","","color","primary",3,"click"],["mat-stroked-button","","color","warn","cdkFocusInitial","",3,"click"]],template:function(d,A){1&d&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"mat-label",2),s._uU(3),s.ALo(4,"translate"),s.qZA(),s.qZA(),s.TgZ(5,"div",3),s.TgZ(6,"button",4),s.NdJ("click",function(){return A.onNoClick()}),s._uU(7),s.ALo(8,"translate"),s.qZA(),s.TgZ(9,"button",5),s.NdJ("click",function(){return A.delete()}),s._uU(10),s.ALo(11,"translate"),s.qZA(),s.qZA(),s.qZA()),2&d&&(s.xp6(3),s.Oqu(s.lcZ(4,3,"BUTTON.DELETE-CONFIRMATION")),s.xp6(4),s.Oqu(s.lcZ(8,5,"BUTTON.CANCEL")),s.xp6(3),s.Oqu(s.lcZ(11,7,"BUTTON.DELETE")))},directives:[n.xw,g.xY,m.hX,g.H8,n.Wh,n.SQ,x.lW],pipes:[R.X$],styles:[""]}),T})()}}]);