"use strict";(self.webpackChunksolidapp=self.webpackChunksolidapp||[]).push([[4833],{4833:($,S,l)=>{l.d(S,{q:()=>K});var h=l(449),C=l(8258),e=l(5e3),r=l(149),m=l(9808),p=l(9291),g=l(1062),d=l(7093),I=l(3918),b=l(7423),f=l(6688),L=l(7446),v=l(3874),Z=l(7322);const u=function(){return{width:"15px",height:"15px"}},x=function(){return{"border-radius":"0",height:"15px"}};function w(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"ngx-skeleton-loader",8),e._UZ(2,"ngx-skeleton-loader",12),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("animation",t.animation)("theme",e.DdM(4,u)),e.xp6(1),e.Q6J("animation",t.animation)("theme",e.DdM(5,x))}}const y=function(){return[1,2,3,4]};function A(n,a){if(1&n&&(e.TgZ(0,"div",6),e.TgZ(1,"div",7),e._UZ(2,"ngx-skeleton-loader",8),e._UZ(3,"ngx-skeleton-loader",9),e.qZA(),e.YNc(4,w,3,6,"div",10),e.qZA()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("animation",t.animation)("theme",e.DdM(5,u)),e.xp6(1),e.Q6J("animation",t.animation)("theme",e.DdM(6,x)),e.xp6(1),e.Q6J("ngForOf",e.DdM(7,y))}}const O=function(){return[1,2]};function P(n,a){1&n&&(e.TgZ(0,"div",4),e.YNc(1,A,5,8,"div",5),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngForOf",e.DdM(1,O)))}function N(n,a){if(1&n&&(e.TgZ(0,"mat-icon",25),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(t.icon)}}function M(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-checkbox",23),e.NdJ("change",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(3).todoLeafItemSelectionToggle(o)}),e.YNc(1,N,2,1,"mat-icon",24),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("checked",i.checklistSelection.isSelected(t))("disabled",i.isDisabled),e.xp6(1),e.Q6J("ngIf",i.hasIcon),e.xp6(1),e.hij(" ",e.lcZ(3,4,t[i.displayLabel])," ")}}function D(n,a){if(1&n&&(e.TgZ(0,"mat-icon",25),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(t.icon)}}function k(n,a){if(1&n&&(e.TgZ(0,"mat-label",26),e.YNc(1,D,2,1,"mat-icon",24),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("routerLink",t.linkUrl),e.xp6(1),e.Q6J("ngIf",i.hasIcon),e.xp6(1),e.hij(" ",e.lcZ(3,3,t[i.displayLabel])," ")}}function E(n,a){if(1&n&&(e.TgZ(0,"mat-chip"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.billcode)}}function U(n,a){if(1&n&&(e.TgZ(0,"mat-tree-node",17),e.TgZ(1,"li",18),e._UZ(2,"button",19),e.YNc(3,M,4,6,"mat-checkbox",20),e.YNc(4,k,4,5,"mat-label",21),e.TgZ(5,"mat-chip-list",22),e.YNc(6,E,2,1,"mat-chip",2),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("matTreeNodePaddingIndent",10),e.xp6(3),e.Q6J("ngIf",t.treeSettings.isSelectable),e.xp6(1),e.Q6J("ngIf",!t.treeSettings.isSelectable),e.xp6(2),e.Q6J("ngIf",t.showChip)}}function J(n,a){if(1&n&&(e.TgZ(0,"mat-icon",25),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(t.icon)}}function Q(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-checkbox",33),e.NdJ("change",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw(3);return s.hasMultipleSelection?s.todoItemSelectionToggle(o):s.todoLeafItemSelectionToggle(o)}),e.YNc(1,J,2,1,"mat-icon",24),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("checked",i.hasMultipleSelection?i.descendantsAllSelected(t):i.checklistSelection.isSelected(t))("disabled",i.isDisabled)("indeterminate",i.hasMultipleSelection?i.descendantsPartiallySelected(t):null),e.xp6(1),e.Q6J("ngIf",i.hasIcon),e.xp6(1),e.hij(" ",e.lcZ(3,5,t[i.displayLabel])," ")}}function Y(n,a){if(1&n&&(e.TgZ(0,"mat-icon",25),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(t.icon)}}function q(n,a){if(1&n&&(e.TgZ(0,"mat-label",34),e.YNc(1,Y,2,1,"mat-icon",24),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.hasIcon),e.xp6(1),e.hij(" ",e.lcZ(3,2,t[i.displayLabel])," ")}}function R(n,a){if(1&n&&(e.TgZ(0,"mat-nested-tree-node",27),e.TgZ(1,"li"),e.TgZ(2,"div",18),e.TgZ(3,"button",28),e.TgZ(4,"mat-icon",29),e._uU(5),e.qZA(),e.qZA(),e.YNc(6,Q,4,7,"mat-checkbox",30),e.YNc(7,q,4,4,"mat-label",31),e.qZA(),e.TgZ(8,"ul"),e.GkF(9,32),e.qZA(),e.qZA(),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("matTreeNodePaddingIndent",10),e.xp6(3),e.uIk("aria-label","toggle "+t.label),e.xp6(2),e.hij(" ",i.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),e.xp6(1),e.Q6J("ngIf",i.treeSettings.isSelectable),e.xp6(1),e.Q6J("ngIf",!i.treeSettings.isSelectable),e.xp6(1),e.ekj("example-tree-invisible",!i.treeControl.isExpanded(t))}}function W(n,a){if(1&n&&(e.TgZ(0,"mat-tree",14),e.YNc(1,U,7,4,"mat-tree-node",15),e.YNc(2,R,10,7,"mat-nested-tree-node",16),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("dataSource",t.dataSource)("treeControl",t.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",t.hasChild)}}function B(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,W,3,3,"mat-tree",13),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.dataSource)}}function F(n,a){1&n&&(e.TgZ(0,"div",35),e.TgZ(1,"mat-label",36),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.hij("",e.lcZ(3,1,"COMMON.NO")," data found"))}let K=(()=>{class n{constructor(t,i,o,s,c){this.location=t,this.cdr=i,this.router=o,this.route=s,this.translate=c,this.selectedList=[],this.isSelectable=!1,this.treeSettings={},this.isLoading=!1,this.showView=!1,this.treeSelection=[],this.selection=new e.vpe,this.permissionView=!1,this.isDisabled=!1,this.parentProperty="code",this.childProperty="parent",this.displayLabel="display_name",this.isItemSelectable=!0,this.hasMultipleSelection=!0,this.hasIcon=!1,this.showChip=!1,this.expandOnLoad=!1,this.sortLables=!1,this.dataLoaded=!1,this.showTree=!1,this.showNoRecords=!1,this.showSkeleton=!1,this.animation="pulse",this.treeControl=new C.VY(_=>_.children),this.dataSource=new r.WX,this.checklistSelection=new h.Ov(this.hasMultipleSelection),this.getChildren=_=>_.children,this.hasChild=(_,T)=>!!T.children&&T.children.length>0}ngOnInit(){this.checklistSelection=new h.Ov(this.hasMultipleSelection),this.treeView=JSON.parse(localStorage.getItem("template")||"null"),this.dataLoaded?(this.showSkeleton=!1,this.treedata&&this.treedata.length>0?(this.permissionView=!0,this.processTreeData(this.treedata),this.showTree=!1,this.showNoRecords=!1):(this.showTree=!1,this.showNoRecords=!1)):this.showSkeleton=!0,this.templateId=this.route.snapshot.paramMap.get("id"),this.isItemSelectable&&(this.treeSettings.isSelectable=this.isItemSelectable)}ngOnChanges(){this.isItemSelectable&&(this.treeSettings.isSelectable=this.isItemSelectable),this.dataLoaded?(this.showSkeleton=!1,this.treedata&&this.treedata.length>0?(this.permissionView=!0,this.processTreeData(this.treedata),this.showTree=!0,this.showNoRecords=!1):(this.showTree=!1,this.showNoRecords=!0),this.isItemSelectable&&(this.treeSettings.isSelectable=this.isItemSelectable)):this.showSkeleton=!0}prepareinitialSelectedList(t,i){if((this.treeSelection.includes(t.code)||this.treeSelection.includes(t.id)||this.treeSelection.includes(t.name)||this.treeSelection.includes(t[this.parentProperty]))&&(i.push(t),this.checklistSelection=new h.Ov(this.hasMultipleSelection,i,!0),this.checklistSelection.select(t)),t.children&&t.children.length>0)for(const o of t.children)this.prepareinitialSelectedList(o,i)}descendantsAllSelected(t){return this.treeControl.getDescendants(t).every(s=>this.checklistSelection.isSelected(s))}descendantsPartiallySelected(t){return this.treeControl.getDescendants(t).some(s=>this.checklistSelection.isSelected(s))&&!this.descendantsAllSelected(t)}todoItemSelectionToggle(t){this.checklistSelection.toggle(t);const i=this.treeControl.getDescendants(t);this.checklistSelection.isSelected(t)?this.checklistSelection.select(...i):this.checklistSelection.deselect(...i),i.every(o=>this.checklistSelection.isSelected(o)),this.checklistSelection.selected&&this.emitSelection()}todoLeafItemSelectionToggle(t){this.checklistSelection.toggle(t),this.checklistSelection.selected&&this.emitSelection()}list_to_tree(t){var i;const o=[];let s,c;const _=[];for(c=0;c<t.length;c+=1)o[t[c][this.parentProperty]]=c,t[c].children=[];for(c=0;c<t.length;c+=1)s=t[c],s&&(s[this.childProperty]?((null===(i=t[o[s[this.childProperty]]])||void 0===i?void 0:i.children)||(t[o[s[this.childProperty]]].children=[]),t[o[s[this.childProperty]]].children.push(s)):_.push(s));return _}processTreeData(t){this.treeData=this.list_to_tree(t),this.sortLables&&this.parseNodes(this.treeData),this.dataSource.data=this.treeData,this.treeControl.dataNodes=this.treeData;const i=[];if(this.treeSelection)for(const o of this.treeData)this.prepareinitialSelectedList(o,i);this.expandOnLoad&&this.treeControl.expandAll(),this.cdr.detectChanges()}parseNodes(t){for(const i of t)void 0!==i.children&&(i.children=this.sortTree(i.children),this.parseNodes(i.children))}sortTree(t){return t.sort(function(i,o){return i.display_name<o.display_name?-1:i.display_name>o.display_name?1:0})}emitSelection(){let t={},i=[];this.hasMultipleSelection?(i=this.checklistSelection.selected.map(this.permissionView?o=>o.code:o=>o.id),t={id:this.permissionView?null:this.config._id,outputName:this.treeSettings.outputName,selectedNodes:this.checklistSelection.selected,selectedIds:i}):(i=this.checklistSelection.selected.map(o=>o[this.parentProperty]),t={selectedNodes:this.checklistSelection.selected,selectedIds:i}),this.selection.emit(t)}onViewClick(){this.showView=!0}goBack(){this.location.back()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.Ye),e.Y36(e.sBO),e.Y36(p.F0),e.Y36(p.gz),e.Y36(g.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-shared-tree"]],inputs:{treeSelection:"treeSelection",config:"config",treedata:"treedata",isDisabled:"isDisabled",parentProperty:"parentProperty",childProperty:"childProperty",displayLabel:"displayLabel",isItemSelectable:"isItemSelectable",hasMultipleSelection:"hasMultipleSelection",hasIcon:"hasIcon",showChip:"showChip",expandOnLoad:"expandOnLoad",sortLables:"sortLables",dataLoaded:"dataLoaded"},outputs:{selection:"selection"},features:[e.TTD],decls:4,vars:3,consts:[[1,"mat-typography","mr-1"],["class","p-4","fxLayout","column",4,"ngIf"],[4,"ngIf"],["fxLayout","row","fxFlex","100","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","column",1,"p-4"],["fxLayout","column","fxLayoutAlign","start end","fxLayoutGap","10px",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","start end","fxLayoutGap","10px"],["fxLayoutAlign","start end","fxLayoutGap","10px",1,"first-section-wrapper"],[3,"animation","theme"],["fxFlex","25",3,"animation","theme"],["class","first-section-wrapper pl-4 pr-4","fxLayoutAlign","start end","fxLayoutGap","10px",4,"ngFor","ngForOf"],["fxLayoutAlign","start end","fxLayoutGap","10px",1,"first-section-wrapper","pl-4","pr-4"],["fxFlex","20",3,"animation","theme"],["class","example-tree",3,"dataSource","treeControl",4,"ngIf"],[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",3,"matTreeNodePaddingIndent",4,"matTreeNodeDef"],["matTreeNodePadding","",3,"matTreeNodePaddingIndent",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding","",3,"matTreeNodePaddingIndent"],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],[3,"checked","disabled","change",4,"ngIf"],["style","cursor: pointer",3,"routerLink",4,"ngIf"],[2,"margin-left","5px"],[3,"checked","disabled","change"],["class","vertical-align-botm",4,"ngIf"],[1,"vertical-align-botm"],[2,"cursor","pointer",3,"routerLink"],["matTreeNodePadding","",3,"matTreeNodePaddingIndent"],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],[3,"checked","disabled","indeterminate","change",4,"ngIf"],["style","cursor: pointer","matTreeNodeToggle","",4,"ngIf"],["matTreeNodeOutlet",""],[3,"checked","disabled","indeterminate","change"],["matTreeNodeToggle","",2,"cursor","pointer"],["fxLayout","row","fxFlex","100","fxLayoutAlign","center center"],[1,"mat-h3","mb-0"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,P,2,2,"div",1),e.YNc(2,B,2,1,"div",2),e.YNc(3,F,4,3,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.showSkeleton),e.xp6(1),e.Q6J("ngIf",i.showTree),e.xp6(1),e.Q6J("ngIf",i.showNoRecords))},directives:[m.O5,d.xw,m.sg,d.Wh,d.SQ,I.xr,d.yH,r.gi,r.fQ,r.uo,r.eu,r.ah,b.lW,f.qn,L.oG,v.Hw,Z.hX,p.rH,f.HS,r.GZ,r.Ar],pipes:[g.X$],styles:[".mat-tree-node[_ngcontent-%COMP%]{min-height:40px}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none;padding-left:10px!important}.vertical-align-botm[_ngcontent-%COMP%]{vertical-align:sub}"]}),n})()}}]);